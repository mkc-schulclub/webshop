<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MKC Shop</title>
    <link rel="icon" type="image/vnd.microsoft.icon" href="./images/mkclogo.ico">
    <script src="https://unpkg.com/vue@3"></script>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="./app.js" defer></script>
</head>
<body style="color: rgb(0, 0, 0);">
    <div class="loading-backdrop" v-if="loading">
        <div class="loading-content">
            <span class="loading-text">Laden</span>
            <span class="loading-dots">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
            </span>
        </div>
        </div>
    <nav class="navbar navbar-expand-lg">
        <a class="navbar-brand" href="" @click.prevent="activePage = 0">MKC Merch-Store</a>
        <div class="container-fluid">
            <ul id="navcontent" class="navbar-nav me-auto mb-2 mb-lg-0">
                <li v-for="(page, index) in pages" class="nav-item" :key="index">
                    <a 
                        class="nav-link"
                        :class="{active: activePage == index}" 
                        aria-current="page" 
                        :href="page.link.url"
                        :title="`This link goes to the ${page.link.text} page`"
                        @click.prevent="activePage = index"
                        >{{ page.link.text }}
                        <span class="item-count" v-if="index === 1"
                    >
                            ({{ cartItemCount }})
                        </span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
    <div id="content" class="container">
        <h1>{{ pages[activePage].pageTitle }}</h1>
        <p>{{ pages[activePage].content }}</p>
        <p v-if="activePage == 1 && !cart.length">{{ "Der Warenkorb ist leer" }}</p>
        <div class="products" v-if="activePage === 0">
            <h2>Produkte</h2><br>
            <ul v-for="(product, index) in products" :key="index">
                <div class="productcontainer">
                    <div class="text">
                        <h3>{{ product.name }}</h3>
                        <div class="selections">
                        <span v-if="product.sizes && product.sizes.length > 0">
                            Größen:
                            <select v-model="product.selectedSize">
                            <option v-for="size in product.sizes" :key="size" :value="size">{{ size }}</option>
                            </select>
                        </span>
                        <span v-if="product.colors && product.colors.length > 0">
                            Farben:
                            <select v-model="product.selectedColor">
                                <option v-for="color in product.colors" :key="color" :value="color">{{ color }}</option>
                            </select>
                        </span>
                        <br>
                        <span v-if="product.motives && product.motives.length > 0"> 
                            Motive:
                            <select v-model="product.selectedMotive">
                                <option v-for="motive in product.motives" :key="motive[0]" :value="motive">{{ motive[1] }}</option>
                            </select>
                          </span>
                          <span v-if="product.variations && product.variations.length > 0"> 
                            Variationen:
                            <select v-model="product.selectedVariation">
                              <option v-for="variation in product.variations" :key="variation[0]" :value="variation">{{ variation[1] }}</option>
                            </select>
                          </span>
                          <br><br>
                          <div style="width: 10">
                                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed commodo sagittis fringilla. Integer at est risus. 
                                Curabitur risus nunc, finibus sed gravida ac, tempus eget justo. Nam aliquam pharetra sapien. 
                                Mauris ut eros nec tellus gravida scelerisque non vel sapien. Cras eget sapien et purus dapibus sagittis. 
                                Suspendisse laoreet purus sed vehicula congue.
                          </div>
                        <div>
                        </div>
                    </div>
                    <button @click.prevent="addToCart(product)" :disabled="!propertiesSelected(product)" :class="{ 'disabled-button': !propertiesSelected(product)}">
                        <img src="./images/cart.png" alt="Zum Warenkorb hinzufügen" width="20"/>
                    </button>                                                                                        
                    </div>
                    <div class="image" style="width: 600vh; height: auto;">
                        <img src="./images/IMG_2386.jpg" height="300">
                    </div>
                </div>
            </ul>
        </div>
        </div>
        <div class="cart" v-if="activePage === 1">
            <ul v-for="(product, index) in cart" :key="index">
                <div>
                    <h3>{{ product.name }}</h3>
                    <div class="image">
                        <img src="./images/cart.png">
                    </div>
                    <ul v-if="product.color"><b>Farbe:</b> {{ product.color }}</ul>
                    <ul v-if="product.size"><b>Größe:</b> {{ product.size }}</ul>
                    <ul v-if="product.motive"><b>Motiv:</b> {{ Object.values(product.motive)[0] }}</ul>
                    <ul v-if="product.variation"><b>Variation:</b> {{ Object.values(product.variation)[0] }}</ul>
                    <ul><b>Preis:</b> {{ `${product.price}€` }}</ul>
                    <ul><b>Anzahl:</b>{{ product.amount }}</ul>
                    <div>
                        <button @click.prevent="removeFromCart(product)">
                            <img src="./images/bin.png" alt="Aus dem Warenkorb entfernen" width="15"/>
                        </button>
                    </div>
                    <!-- error popup might go here -->
                </div>
            </ul>
            <button v-if="cart.length" class="submitCartBtn" @click.prevent="submitCart()">Bestellformular verarbeiten</button>
            <br>
            <a style="margin-left: 30%;" v-if="pdf" :href="pdf">Hier clicken, um das Bestellformular herunterzuladen!</a>
        </div>
    </div>
        <div>
          <div v-if="!!popup" class="dialog-overlay">
            <div class="dialog-content">
              <h2>{{ popTitle }}</h2>
              <p>{{ popMessage }}</p>
              <button @click="closePop">Schließen</button>
            </div>
          </div>
        </div>
</body>
</html>